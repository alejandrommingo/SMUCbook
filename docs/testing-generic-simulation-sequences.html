<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>4.6 Testing Generic Simulation Sequences | Simulation and Modeling to Understand the Change</title>
  <meta name="description" content="These are lecture notes for the module Simulation and Modelling to Understand Change given in the School of Human Sciences and Technology at IE University, Madrid, Spain. The module is given in the 2nd semester of the 1st year of the bachelor in Data and Business Analytics. Knowledge of basic elements of R programming as well as probability and statistics is assumed." />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="4.6 Testing Generic Simulation Sequences | Simulation and Modeling to Understand the Change" />
  <meta property="og:type" content="book" />
  
  <meta property="og:image" content="/images/Rplot.png" />
  <meta property="og:description" content="These are lecture notes for the module Simulation and Modelling to Understand Change given in the School of Human Sciences and Technology at IE University, Madrid, Spain. The module is given in the 2nd semester of the 1st year of the bachelor in Data and Business Analytics. Knowledge of basic elements of R programming as well as probability and statistics is assumed." />
  <meta name="github-repo" content="amartinezm90/SMUCbook" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="4.6 Testing Generic Simulation Sequences | Simulation and Modeling to Understand the Change" />
  
  <meta name="twitter:description" content="These are lecture notes for the module Simulation and Modelling to Understand Change given in the School of Human Sciences and Technology at IE University, Madrid, Spain. The module is given in the 2nd semester of the 1st year of the bachelor in Data and Business Analytics. Knowledge of basic elements of R programming as well as probability and statistics is assumed." />
  <meta name="twitter:image" content="/images/Rplot.png" />

<meta name="author" content="Alejandro Martínez-Mingo &amp; Manuele Leonelli" />


<meta name="date" content="2022-01-07" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="random-variate-generation.html"/>
<link rel="next" href="monte-carlo-simulation.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>
<script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
<script src="libs/viz-1.8.2/viz.js"></script>
<link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet" />
<script src="libs/grViz-binding-1.0.6.1/grViz.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">SMUC</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="1" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>1</b> Introduction</a>
<ul>
<li class="chapter" data-level="1.1" data-path="what-is-simulation.html"><a href="what-is-simulation.html"><i class="fa fa-check"></i><b>1.1</b> What is simulation</a>
<ul>
<li class="chapter" data-level="1.1.1" data-path="what-is-simulation.html"><a href="what-is-simulation.html#a-simple-simulation-model"><i class="fa fa-check"></i><b>1.1.1</b> A simple simulation model</a></li>
<li class="chapter" data-level="1.1.2" data-path="what-is-simulation.html"><a href="what-is-simulation.html#why-simulate"><i class="fa fa-check"></i><b>1.1.2</b> Why simulate?</a></li>
</ul></li>
<li class="chapter" data-level="1.2" data-path="types-of-simulations.html"><a href="types-of-simulations.html"><i class="fa fa-check"></i><b>1.2</b> Types of simulations</a>
<ul>
<li class="chapter" data-level="1.2.1" data-path="types-of-simulations.html"><a href="types-of-simulations.html#stochastic-vs-deterministic-simulations"><i class="fa fa-check"></i><b>1.2.1</b> Stochastic vs deterministic simulations</a></li>
<li class="chapter" data-level="1.2.2" data-path="types-of-simulations.html"><a href="types-of-simulations.html#static-vs-dynamic-simulations"><i class="fa fa-check"></i><b>1.2.2</b> Static vs dynamic simulations</a></li>
<li class="chapter" data-level="1.2.3" data-path="types-of-simulations.html"><a href="types-of-simulations.html#discrete-vs-continuous-simulations"><i class="fa fa-check"></i><b>1.2.3</b> Discrete vs continuous simulations</a></li>
</ul></li>
<li class="chapter" data-level="1.3" data-path="elements-of-a-simulation-model.html"><a href="elements-of-a-simulation-model.html"><i class="fa fa-check"></i><b>1.3</b> Elements of a simulation model</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="elements-of-a-simulation-model.html"><a href="elements-of-a-simulation-model.html#objects-of-the-model"><i class="fa fa-check"></i><b>1.3.1</b> Objects of the model</a></li>
<li class="chapter" data-level="1.3.2" data-path="elements-of-a-simulation-model.html"><a href="elements-of-a-simulation-model.html#organization-of-entities-and-resources"><i class="fa fa-check"></i><b>1.3.2</b> Organization of entities and resources</a></li>
<li class="chapter" data-level="1.3.3" data-path="elements-of-a-simulation-model.html"><a href="elements-of-a-simulation-model.html#operations-of-the-objects"><i class="fa fa-check"></i><b>1.3.3</b> Operations of the objects</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="the-donut-shop-example.html"><a href="the-donut-shop-example.html"><i class="fa fa-check"></i><b>1.4</b> The donut shop example</a></li>
<li class="chapter" data-level="1.5" data-path="simulating-a-little-health-center.html"><a href="simulating-a-little-health-center.html"><i class="fa fa-check"></i><b>1.5</b> Simulating a little health center</a></li>
<li class="chapter" data-level="1.6" data-path="whats-next.html"><a href="whats-next.html"><i class="fa fa-check"></i><b>1.6</b> What’s next</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r-programming.html"><a href="r-programming.html"><i class="fa fa-check"></i><b>2</b> R programming</a>
<ul>
<li class="chapter" data-level="2.1" data-path="why-r.html"><a href="why-r.html"><i class="fa fa-check"></i><b>2.1</b> Why R?</a></li>
<li class="chapter" data-level="2.2" data-path="section-bibliography.html"><a href="section-bibliography.html"><i class="fa fa-check"></i><b>2.2</b> Section Bibliography</a></li>
<li class="chapter" data-level="2.3" data-path="r-basics.html"><a href="r-basics.html"><i class="fa fa-check"></i><b>2.3</b> R basics</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="r-basics.html"><a href="r-basics.html#introduction-to-r"><i class="fa fa-check"></i><b>2.3.1</b> Introduction to R</a></li>
<li class="chapter" data-level="2.3.2" data-path="r-basics.html"><a href="r-basics.html#r-history"><i class="fa fa-check"></i><b>2.3.2</b> R History</a></li>
<li class="chapter" data-level="2.3.3" data-path="r-basics.html"><a href="r-basics.html#r-advantages"><i class="fa fa-check"></i><b>2.3.3</b> R Advantages</a></li>
<li class="chapter" data-level="2.3.4" data-path="r-basics.html"><a href="r-basics.html#what-do-we-mean-by-r"><i class="fa fa-check"></i><b>2.3.4</b> What do we mean by R?</a></li>
<li class="chapter" data-level="2.3.5" data-path="r-basics.html"><a href="r-basics.html#console-mode"><i class="fa fa-check"></i><b>2.3.5</b> Console Mode</a></li>
<li class="chapter" data-level="2.3.6" data-path="r-basics.html"><a href="r-basics.html#getting-help-in-r"><i class="fa fa-check"></i><b>2.3.6</b> Getting help in R</a></li>
<li class="chapter" data-level="2.3.7" data-path="r-basics.html"><a href="r-basics.html#packages-in-r"><i class="fa fa-check"></i><b>2.3.7</b> Packages in R</a></li>
<li class="chapter" data-level="2.3.8" data-path="r-basics.html"><a href="r-basics.html#built-in-r-libraries"><i class="fa fa-check"></i><b>2.3.8</b> Built-in R libraries</a></li>
<li class="chapter" data-level="2.3.9" data-path="r-basics.html"><a href="r-basics.html#contents-of-packages"><i class="fa fa-check"></i><b>2.3.9</b> Contents of Packages</a></li>
<li class="chapter" data-level="2.3.10" data-path="r-basics.html"><a href="r-basics.html#installing-packages"><i class="fa fa-check"></i><b>2.3.10</b> Installing Packages</a></li>
<li class="chapter" data-level="2.3.11" data-path="r-basics.html"><a href="r-basics.html#command-line-versus-scripts"><i class="fa fa-check"></i><b>2.3.11</b> Command line versus scripts</a></li>
<li class="chapter" data-level="2.3.12" data-path="r-basics.html"><a href="r-basics.html#rstudio"><i class="fa fa-check"></i><b>2.3.12</b> RStudio</a></li>
<li class="chapter" data-level="2.3.13" data-path="r-basics.html"><a href="r-basics.html#working-directory"><i class="fa fa-check"></i><b>2.3.13</b> Working Directory</a></li>
<li class="chapter" data-level="2.3.14" data-path="r-basics.html"><a href="r-basics.html#exercise-set-up-your-working-directory"><i class="fa fa-check"></i><b>2.3.14</b> Exercise: Set up your Working Directory</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="expressions-objects-and-symbols.html"><a href="expressions-objects-and-symbols.html"><i class="fa fa-check"></i><b>2.4</b> Expressions, Objects and Symbols</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="expressions-objects-and-symbols.html"><a href="expressions-objects-and-symbols.html#some-examples-to-start-with"><i class="fa fa-check"></i><b>2.4.1</b> Some examples to start with</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="r-as-a-calculator.html"><a href="r-as-a-calculator.html"><i class="fa fa-check"></i><b>2.5</b> R as a Calculator</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="r-as-a-calculator.html"><a href="r-as-a-calculator.html#complex-numbers-in-r"><i class="fa fa-check"></i><b>2.5.1</b> Complex numbers in R</a></li>
<li class="chapter" data-level="2.5.2" data-path="r-as-a-calculator.html"><a href="r-as-a-calculator.html#rounding"><i class="fa fa-check"></i><b>2.5.2</b> Rounding</a></li>
<li class="chapter" data-level="2.5.3" data-path="r-as-a-calculator.html"><a href="r-as-a-calculator.html#arithmetics"><i class="fa fa-check"></i><b>2.5.3</b> Arithmetics</a></li>
<li class="chapter" data-level="2.5.4" data-path="r-as-a-calculator.html"><a href="r-as-a-calculator.html#modulo-and-integer-quotients"><i class="fa fa-check"></i><b>2.5.4</b> Modulo and integer quotients</a></li>
<li class="chapter" data-level="2.5.5" data-path="r-as-a-calculator.html"><a href="r-as-a-calculator.html#operators"><i class="fa fa-check"></i><b>2.5.5</b> Operators</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="r-basic-data-types.html"><a href="r-basic-data-types.html"><i class="fa fa-check"></i><b>2.6</b> R Basic Data types</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="r-basic-data-types.html"><a href="r-basic-data-types.html#integers"><i class="fa fa-check"></i><b>2.6.1</b> Integers</a></li>
<li class="chapter" data-level="2.6.2" data-path="r-basic-data-types.html"><a href="r-basic-data-types.html#integer-vs.-double"><i class="fa fa-check"></i><b>2.6.2</b> Integer vs. Double</a></li>
<li class="chapter" data-level="2.6.3" data-path="r-basic-data-types.html"><a href="r-basic-data-types.html#logical-operators"><i class="fa fa-check"></i><b>2.6.3</b> Logical operators</a></li>
<li class="chapter" data-level="2.6.4" data-path="r-basic-data-types.html"><a href="r-basic-data-types.html#real-numbers-equality"><i class="fa fa-check"></i><b>2.6.4</b> Real numbers equality</a></li>
<li class="chapter" data-level="2.6.5" data-path="r-basic-data-types.html"><a href="r-basic-data-types.html#logical-arithmetic"><i class="fa fa-check"></i><b>2.6.5</b> Logical arithmetic</a></li>
<li class="chapter" data-level="2.6.6" data-path="r-basic-data-types.html"><a href="r-basic-data-types.html#characters"><i class="fa fa-check"></i><b>2.6.6</b> Characters</a></li>
<li class="chapter" data-level="2.6.7" data-path="r-basic-data-types.html"><a href="r-basic-data-types.html#characters-letters-vectors"><i class="fa fa-check"></i><b>2.6.7</b> Characters: letters vectors</a></li>
<li class="chapter" data-level="2.6.8" data-path="r-basic-data-types.html"><a href="r-basic-data-types.html#characters-pasting-strings-together"><i class="fa fa-check"></i><b>2.6.8</b> Characters: Pasting strings together</a></li>
<li class="chapter" data-level="2.6.9" data-path="r-basic-data-types.html"><a href="r-basic-data-types.html#characters-extracting-parts-of-strings"><i class="fa fa-check"></i><b>2.6.9</b> Characters: Extracting parts of strings</a></li>
<li class="chapter" data-level="2.6.10" data-path="r-basic-data-types.html"><a href="r-basic-data-types.html#characters-counting-things-within-strings"><i class="fa fa-check"></i><b>2.6.10</b> Characters: Counting things within strings</a></li>
<li class="chapter" data-level="2.6.11" data-path="r-basic-data-types.html"><a href="r-basic-data-types.html#characters-upper--and-lower-case-text"><i class="fa fa-check"></i><b>2.6.11</b> Characters: Upper- and lower-case text</a></li>
<li class="chapter" data-level="2.6.12" data-path="r-basic-data-types.html"><a href="r-basic-data-types.html#dates-and-times"><i class="fa fa-check"></i><b>2.6.12</b> Dates and times</a></li>
<li class="chapter" data-level="2.6.13" data-path="r-basic-data-types.html"><a href="r-basic-data-types.html#dates-and-times-reading-time-data-from-files"><i class="fa fa-check"></i><b>2.6.13</b> Dates and times: Reading time data from files</a></li>
<li class="chapter" data-level="2.6.14" data-path="r-basic-data-types.html"><a href="r-basic-data-types.html#dates-and-times-the-strptime-function"><i class="fa fa-check"></i><b>2.6.14</b> Dates and times: The <code>strptime</code> function</a></li>
<li class="chapter" data-level="2.6.15" data-path="r-basic-data-types.html"><a href="r-basic-data-types.html#dates-and-times-summary"><i class="fa fa-check"></i><b>2.6.15</b> Dates and times: Summary</a></li>
<li class="chapter" data-level="2.6.16" data-path="r-basic-data-types.html"><a href="r-basic-data-types.html#testing-and-coercing"><i class="fa fa-check"></i><b>2.6.16</b> Testing and coercing</a></li>
<li class="chapter" data-level="2.6.17" data-path="r-basic-data-types.html"><a href="r-basic-data-types.html#missing-values-infinity-and-things-that-are-not-numbers"><i class="fa fa-check"></i><b>2.6.17</b> Missing values, infinity and things that are not numbers</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="r-basic-data-structures.html"><a href="r-basic-data-structures.html"><i class="fa fa-check"></i><b>2.7</b> R Basic Data Structures</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="r-basic-data-structures.html"><a href="r-basic-data-structures.html#vectors"><i class="fa fa-check"></i><b>2.7.1</b> Vectors</a></li>
<li class="chapter" data-level="2.7.2" data-path="r-basic-data-structures.html"><a href="r-basic-data-structures.html#sequences"><i class="fa fa-check"></i><b>2.7.2</b> Sequences</a></li>
<li class="chapter" data-level="2.7.3" data-path="r-basic-data-structures.html"><a href="r-basic-data-structures.html#vector-and-subscripts"><i class="fa fa-check"></i><b>2.7.3</b> Vector and Subscripts</a></li>
<li class="chapter" data-level="2.7.4" data-path="r-basic-data-structures.html"><a href="r-basic-data-structures.html#vector-operations"><i class="fa fa-check"></i><b>2.7.4</b> Vector Operations</a></li>
<li class="chapter" data-level="2.7.5" data-path="r-basic-data-structures.html"><a href="r-basic-data-structures.html#vector-functions"><i class="fa fa-check"></i><b>2.7.5</b> Vector Functions</a></li>
<li class="chapter" data-level="2.7.6" data-path="r-basic-data-structures.html"><a href="r-basic-data-structures.html#sets"><i class="fa fa-check"></i><b>2.7.6</b> Sets</a></li>
<li class="chapter" data-level="2.7.7" data-path="r-basic-data-structures.html"><a href="r-basic-data-structures.html#factors"><i class="fa fa-check"></i><b>2.7.7</b> Factors</a></li>
<li class="chapter" data-level="2.7.8" data-path="r-basic-data-structures.html"><a href="r-basic-data-structures.html#matrices-and-arrays"><i class="fa fa-check"></i><b>2.7.8</b> Matrices and Arrays</a></li>
<li class="chapter" data-level="2.7.9" data-path="r-basic-data-structures.html"><a href="r-basic-data-structures.html#matrices"><i class="fa fa-check"></i><b>2.7.9</b> Matrices</a></li>
<li class="chapter" data-level="2.7.10" data-path="r-basic-data-structures.html"><a href="r-basic-data-structures.html#lists"><i class="fa fa-check"></i><b>2.7.10</b> Lists</a></li>
<li class="chapter" data-level="2.7.11" data-path="r-basic-data-structures.html"><a href="r-basic-data-structures.html#data-frames"><i class="fa fa-check"></i><b>2.7.11</b> Data Frames</a></li>
</ul></li>
<li class="chapter" data-level="2.8" data-path="control-flow.html"><a href="control-flow.html"><i class="fa fa-check"></i><b>2.8</b> Control Flow</a>
<ul>
<li class="chapter" data-level="2.8.1" data-path="control-flow.html"><a href="control-flow.html#conditional-statements"><i class="fa fa-check"></i><b>2.8.1</b> Conditional statements</a></li>
<li class="chapter" data-level="2.8.2" data-path="control-flow.html"><a href="control-flow.html#loops"><i class="fa fa-check"></i><b>2.8.2</b> Loops</a></li>
<li class="chapter" data-level="2.8.3" data-path="control-flow.html"><a href="control-flow.html#functions"><i class="fa fa-check"></i><b>2.8.3</b> Functions</a></li>
<li class="chapter" data-level="2.8.4" data-path="control-flow.html"><a href="control-flow.html#the-apply-family"><i class="fa fa-check"></i><b>2.8.4</b> The <code>apply</code> Family</a></li>
<li class="chapter" data-level="2.8.5" data-path="control-flow.html"><a href="control-flow.html#apply-family-examples"><i class="fa fa-check"></i><b>2.8.5</b> <code>apply</code> Family Examples</a></li>
</ul></li>
<li class="chapter" data-level="2.9" data-path="the-pipe-operator.html"><a href="the-pipe-operator.html"><i class="fa fa-check"></i><b>2.9</b> The pipe operator</a></li>
<li class="chapter" data-level="2.10" data-path="plotting.html"><a href="plotting.html"><i class="fa fa-check"></i><b>2.10</b> Plotting</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="probability-basics.html"><a href="probability-basics.html"><i class="fa fa-check"></i><b>3</b> Probability Basics</a>
<ul>
<li class="chapter" data-level="3.1" data-path="discrete-random-variables.html"><a href="discrete-random-variables.html"><i class="fa fa-check"></i><b>3.1</b> Discrete Random Variables</a>
<ul>
<li class="chapter" data-level="3.1.1" data-path="discrete-random-variables.html"><a href="discrete-random-variables.html#probability-mass-function"><i class="fa fa-check"></i><b>3.1.1</b> Probability Mass Function</a></li>
<li class="chapter" data-level="3.1.2" data-path="discrete-random-variables.html"><a href="discrete-random-variables.html#cumulative-distribution-function"><i class="fa fa-check"></i><b>3.1.2</b> Cumulative Distribution Function</a></li>
<li class="chapter" data-level="3.1.3" data-path="discrete-random-variables.html"><a href="discrete-random-variables.html#summaries"><i class="fa fa-check"></i><b>3.1.3</b> Summaries</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="notable-discrete-variables.html"><a href="notable-discrete-variables.html"><i class="fa fa-check"></i><b>3.2</b> Notable Discrete Variables</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="notable-discrete-variables.html"><a href="notable-discrete-variables.html#bernoulli-distribution"><i class="fa fa-check"></i><b>3.2.1</b> Bernoulli Distribution</a></li>
<li class="chapter" data-level="3.2.2" data-path="notable-discrete-variables.html"><a href="notable-discrete-variables.html#binomial-distribution"><i class="fa fa-check"></i><b>3.2.2</b> Binomial Distribution</a></li>
<li class="chapter" data-level="3.2.3" data-path="notable-discrete-variables.html"><a href="notable-discrete-variables.html#poisson-distribution"><i class="fa fa-check"></i><b>3.2.3</b> Poisson Distribution</a></li>
<li class="chapter" data-level="3.2.4" data-path="notable-discrete-variables.html"><a href="notable-discrete-variables.html#some-examples"><i class="fa fa-check"></i><b>3.2.4</b> Some Examples</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="continuous-random-variables.html"><a href="continuous-random-variables.html"><i class="fa fa-check"></i><b>3.3</b> Continuous Random Variables</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="continuous-random-variables.html"><a href="continuous-random-variables.html#probability-density-function"><i class="fa fa-check"></i><b>3.3.1</b> Probability Density Function</a></li>
<li class="chapter" data-level="3.3.2" data-path="continuous-random-variables.html"><a href="continuous-random-variables.html#cumulative-distribution-function-1"><i class="fa fa-check"></i><b>3.3.2</b> Cumulative Distribution Function</a></li>
<li class="chapter" data-level="3.3.3" data-path="continuous-random-variables.html"><a href="continuous-random-variables.html#summaries-1"><i class="fa fa-check"></i><b>3.3.3</b> Summaries</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="notable-continuous-distribution.html"><a href="notable-continuous-distribution.html"><i class="fa fa-check"></i><b>3.4</b> Notable Continuous Distribution</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="notable-continuous-distribution.html"><a href="notable-continuous-distribution.html#uniform-distribution"><i class="fa fa-check"></i><b>3.4.1</b> Uniform Distribution</a></li>
<li class="chapter" data-level="3.4.2" data-path="notable-continuous-distribution.html"><a href="notable-continuous-distribution.html#exponential-distribution"><i class="fa fa-check"></i><b>3.4.2</b> Exponential Distribution</a></li>
<li class="chapter" data-level="3.4.3" data-path="notable-continuous-distribution.html"><a href="notable-continuous-distribution.html#normal-distribution"><i class="fa fa-check"></i><b>3.4.3</b> Normal Distribution</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="the-central-limit-theorem.html"><a href="the-central-limit-theorem.html"><i class="fa fa-check"></i><b>3.5</b> The Central Limit Theorem</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="random-number-generation.html"><a href="random-number-generation.html"><i class="fa fa-check"></i><b>4</b> Random Number Generation</a>
<ul>
<li class="chapter" data-level="4.1" data-path="properties-of-random-numbers.html"><a href="properties-of-random-numbers.html"><i class="fa fa-check"></i><b>4.1</b> Properties of Random Numbers</a></li>
<li class="chapter" data-level="4.2" data-path="pseudo-random-numbers.html"><a href="pseudo-random-numbers.html"><i class="fa fa-check"></i><b>4.2</b> Pseudo Random Numbers</a></li>
<li class="chapter" data-level="4.3" data-path="generating-pseudo-random-numbers.html"><a href="generating-pseudo-random-numbers.html"><i class="fa fa-check"></i><b>4.3</b> Generating Pseudo-Random Numbers</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="generating-pseudo-random-numbers.html"><a href="generating-pseudo-random-numbers.html#generating-pseudo-random-numbers-in-r"><i class="fa fa-check"></i><b>4.3.1</b> Generating Pseudo-Random Numbers in R</a></li>
<li class="chapter" data-level="4.3.2" data-path="generating-pseudo-random-numbers.html"><a href="generating-pseudo-random-numbers.html#linear-congruential-method"><i class="fa fa-check"></i><b>4.3.2</b> Linear Congruential Method</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="testing-randomness.html"><a href="testing-randomness.html"><i class="fa fa-check"></i><b>4.4</b> Testing Randomness</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="testing-randomness.html"><a href="testing-randomness.html#testing-uniformity"><i class="fa fa-check"></i><b>4.4.1</b> Testing Uniformity</a></li>
<li class="chapter" data-level="4.4.2" data-path="testing-randomness.html"><a href="testing-randomness.html#testing-independence"><i class="fa fa-check"></i><b>4.4.2</b> Testing Independence</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="random-variate-generation.html"><a href="random-variate-generation.html"><i class="fa fa-check"></i><b>4.5</b> Random Variate Generation</a>
<ul>
<li class="chapter" data-level="4.5.1" data-path="random-variate-generation.html"><a href="random-variate-generation.html#random-generation-in-r"><i class="fa fa-check"></i><b>4.5.1</b> Random Generation in R</a></li>
<li class="chapter" data-level="4.5.2" data-path="random-variate-generation.html"><a href="random-variate-generation.html#the-inverse-transform-method"><i class="fa fa-check"></i><b>4.5.2</b> The Inverse Transform Method</a></li>
<li class="chapter" data-level="4.5.3" data-path="random-variate-generation.html"><a href="random-variate-generation.html#simulating-bernoulli-and-binomial"><i class="fa fa-check"></i><b>4.5.3</b> Simulating Bernoulli and Binomial</a></li>
<li class="chapter" data-level="4.5.4" data-path="random-variate-generation.html"><a href="random-variate-generation.html#simulating-other-distributions"><i class="fa fa-check"></i><b>4.5.4</b> Simulating Other Distributions</a></li>
</ul></li>
<li class="chapter" data-level="4.6" data-path="testing-generic-simulation-sequences.html"><a href="testing-generic-simulation-sequences.html"><i class="fa fa-check"></i><b>4.6</b> Testing Generic Simulation Sequences</a>
<ul>
<li class="chapter" data-level="4.6.1" data-path="testing-generic-simulation-sequences.html"><a href="testing-generic-simulation-sequences.html#testing-distribution-fit"><i class="fa fa-check"></i><b>4.6.1</b> Testing Distribution Fit</a></li>
<li class="chapter" data-level="4.6.2" data-path="testing-generic-simulation-sequences.html"><a href="testing-generic-simulation-sequences.html#testing-independence-1"><i class="fa fa-check"></i><b>4.6.2</b> Testing Independence</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="monte-carlo-simulation.html"><a href="monte-carlo-simulation.html"><i class="fa fa-check"></i><b>5</b> Monte Carlo Simulation</a>
<ul>
<li class="chapter" data-level="5.1" data-path="what-does-monte-carlo-simulation-mean.html"><a href="what-does-monte-carlo-simulation-mean.html"><i class="fa fa-check"></i><b>5.1</b> What does Monte Carlo simulation mean?</a></li>
<li class="chapter" data-level="5.2" data-path="a-bit-of-history.html"><a href="a-bit-of-history.html"><i class="fa fa-check"></i><b>5.2</b> A bit of history</a></li>
<li class="chapter" data-level="5.3" data-path="steps-of-monte-carlo-simulation.html"><a href="steps-of-monte-carlo-simulation.html"><i class="fa fa-check"></i><b>5.3</b> Steps of Monte Carlo simulation</a>
<ul>
<li class="chapter" data-level="5.3.1" data-path="steps-of-monte-carlo-simulation.html"><a href="steps-of-monte-carlo-simulation.html#estimating-pi-step-1"><i class="fa fa-check"></i><b>5.3.1</b> Estimating <span class="math inline">\(\pi\)</span>: step 1</a></li>
<li class="chapter" data-level="5.3.2" data-path="steps-of-monte-carlo-simulation.html"><a href="steps-of-monte-carlo-simulation.html#estimating-pi-step-2"><i class="fa fa-check"></i><b>5.3.2</b> Estimating <span class="math inline">\(\pi\)</span>: step 2</a></li>
<li class="chapter" data-level="5.3.3" data-path="steps-of-monte-carlo-simulation.html"><a href="steps-of-monte-carlo-simulation.html#estimating-pi-step-3"><i class="fa fa-check"></i><b>5.3.3</b> Estimating <span class="math inline">\(\pi\)</span>: step 3</a></li>
<li class="chapter" data-level="5.3.4" data-path="steps-of-monte-carlo-simulation.html"><a href="steps-of-monte-carlo-simulation.html#estimating-pi-step-4"><i class="fa fa-check"></i><b>5.3.4</b> Estimating <span class="math inline">\(\pi\)</span>: step 4</a></li>
<li class="chapter" data-level="5.3.5" data-path="steps-of-monte-carlo-simulation.html"><a href="steps-of-monte-carlo-simulation.html#estimating-pi-step-5"><i class="fa fa-check"></i><b>5.3.5</b> Estimating <span class="math inline">\(\pi\)</span>: step 5</a></li>
<li class="chapter" data-level="5.3.6" data-path="steps-of-monte-carlo-simulation.html"><a href="steps-of-monte-carlo-simulation.html#estimating-pi-conclusions"><i class="fa fa-check"></i><b>5.3.6</b> Estimating <span class="math inline">\(\pi\)</span>: conclusions</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="the-sample-function.html"><a href="the-sample-function.html"><i class="fa fa-check"></i><b>5.4</b> The <code>sample</code> function</a></li>
<li class="chapter" data-level="5.5" data-path="a-game-of-chance.html"><a href="a-game-of-chance.html"><i class="fa fa-check"></i><b>5.5</b> A game of chance</a></li>
<li class="chapter" data-level="5.6" data-path="takeaways.html"><a href="takeaways.html"><i class="fa fa-check"></i><b>5.6</b> Takeaways</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="monte-carlo-methods-for-inference.html"><a href="monte-carlo-methods-for-inference.html"><i class="fa fa-check"></i><b>6</b> Monte Carlo methods for inference</a>
<ul>
<li class="chapter" data-level="6.1" data-path="monte-carlo-for-estimation.html"><a href="monte-carlo-for-estimation.html"><i class="fa fa-check"></i><b>6.1</b> Monte Carlo for estimation</a>
<ul>
<li class="chapter" data-level="6.1.1" data-path="monte-carlo-for-estimation.html"><a href="monte-carlo-for-estimation.html#sam-and-annie-from-sleepless-in-seattle"><i class="fa fa-check"></i><b>6.1.1</b> Sam and Annie from ‘Sleepless in Seattle’</a></li>
</ul></li>
<li class="chapter" data-level="6.2" data-path="general-case-with-standard-normal-distributions.html"><a href="general-case-with-standard-normal-distributions.html"><i class="fa fa-check"></i><b>6.2</b> General Case with Standard Normal Distributions</a></li>
<li class="chapter" data-level="6.3" data-path="the-taxi-problem-comparing-estimators.html"><a href="the-taxi-problem-comparing-estimators.html"><i class="fa fa-check"></i><b>6.3</b> The taxi problem (comparing estimators)</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="discrete-events-simulation-with-r.html"><a href="discrete-events-simulation-with-r.html"><i class="fa fa-check"></i><b>7</b> Discrete Events Simulation with R</a>
<ul>
<li class="chapter" data-level="7.1" data-path="simmer-terminology.html"><a href="simmer-terminology.html"><i class="fa fa-check"></i><b>7.1</b> <code>simmer</code> terminology</a></li>
<li class="chapter" data-level="7.2" data-path="the-trajectory-object.html"><a href="the-trajectory-object.html"><i class="fa fa-check"></i><b>7.2</b> The Trajectory Object</a></li>
<li class="chapter" data-level="7.3" data-path="the-simulation-enviroment.html"><a href="the-simulation-enviroment.html"><i class="fa fa-check"></i><b>7.3</b> The Simulation Enviroment</a></li>
<li class="chapter" data-level="7.4" data-path="monitoring-and-data-retrieval.html"><a href="monitoring-and-data-retrieval.html"><i class="fa fa-check"></i><b>7.4</b> Monitoring and data retrieval</a></li>
<li class="chapter" data-level="7.5" data-path="simmer-example.html"><a href="simmer-example.html"><i class="fa fa-check"></i><b>7.5</b> <code>simmer</code> Example</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Simulation and Modeling to Understand the Change</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="testing-generic-simulation-sequences" class="section level2" number="4.6">
<h2><span class="header-section-number">4.6</span> Testing Generic Simulation Sequences</h2>
<p>In previous sections we spent a lot of effort in assesing if a sequence of numbers could have been a random sequence of independent numbers from a Uniform distribution between zero and one.</p>
<p>Now we will look at the same question, but considering generic distributions we might be interested in. Recall that we had to check two aspects:</p>
<ol style="list-style-type: decimal">
<li><p>if the random sequence had the same distribution as the theoretical one (in previous sections Uniform between zero and one);</p></li>
<li><p>if the sequence was of independent numbers</p></li>
</ol>
<p>We will see that the tools to perform these steps are basically the same.</p>
<div id="testing-distribution-fit" class="section level3" number="4.6.1">
<h3><span class="header-section-number">4.6.1</span> Testing Distribution Fit</h3>
<p>There are various ways to check if the random sequence of observations has the same distribution as the theoretical one.</p>
<div id="histogram" class="section level4" number="4.6.1.1">
<h4><span class="header-section-number">4.6.1.1</span> Histogram</h4>
<p>First, we could construct an histogram of the data sequence and compare it to the theoretical distribution. Suppose we have a sequence of numbers <code>x1</code> that we want to assess if it simulated from a Standard Normal distribution.</p>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb858-1"><a href="testing-generic-simulation-sequences.html#cb858-1" aria-hidden="true" tabindex="-1"></a>x1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x1 =</span><span class="fu">rnorm</span>(<span class="dv">500</span>))</span></code></pre></div>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="testing-generic-simulation-sequences.html#cb859-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x1, <span class="fu">aes</span>(x1)) <span class="sc">+</span></span>
<span id="cb859-2"><a href="testing-generic-simulation-sequences.html#cb859-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density.., <span class="at">colour =</span> <span class="st">&#39;Empirical&#39;</span>), <span class="at">stat =</span> <span class="st">&#39;density&#39;</span>) <span class="sc">+</span></span>
<span id="cb859-3"><a href="testing-generic-simulation-sequences.html#cb859-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&#39;Normal&#39;</span>)) <span class="sc">+</span>      </span>
<span id="cb859-4"><a href="testing-generic-simulation-sequences.html#cb859-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span>      </span>
<span id="cb859-5"><a href="testing-generic-simulation-sequences.html#cb859-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">&#39;Density&#39;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;red&#39;</span>, <span class="st">&#39;blue&#39;</span>)) <span class="sc">+</span></span>
<span id="cb859-6"><a href="testing-generic-simulation-sequences.html#cb859-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:normhist"></span>
<img src="bookdownproj_files/figure-html/normhist-1.png" alt="Histogram of the sequence x1 together with theoretical pdf of the standard Normal" width="50%" />
<p class="caption">
Figure 4.9: Histogram of the sequence x1 together with theoretical pdf of the standard Normal
</p>
</div>
<p>Figure <a href="testing-generic-simulation-sequences.html#fig:normhist">4.9</a> reports the histogram of the sequence <code>x1</code> together with a smooth estimate of the histogram, often called density plot, in the red line. The blue line denotes the theoretical pdf of the standard Normal distribution. We can see that the sequence seems to follow quite closely a Normal distribution and therefore we could be convinced that the numbers are indeed Normal.</p>
<p>Let’s consider a different sequence <code>x2</code>. Figure <a href="testing-generic-simulation-sequences.html#fig:exphist">4.10</a> clearly shows that there is a poor fit between the sequence and the standard Normal distribution. So we would in general not believe that these observations came from a Standard Normal.</p>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="testing-generic-simulation-sequences.html#cb861-1" aria-hidden="true" tabindex="-1"></a>x2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x2 =</span><span class="fu">rnorm</span>(<span class="dv">500</span>,<span class="fl">0.5</span>,<span class="fl">0.6</span>))</span></code></pre></div>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb862-1"><a href="testing-generic-simulation-sequences.html#cb862-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x2, <span class="fu">aes</span>(x2)) <span class="sc">+</span></span>
<span id="cb862-2"><a href="testing-generic-simulation-sequences.html#cb862-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density.., <span class="at">colour =</span> <span class="st">&#39;Empirical&#39;</span>), <span class="at">stat =</span> <span class="st">&#39;density&#39;</span>) <span class="sc">+</span></span>
<span id="cb862-3"><a href="testing-generic-simulation-sequences.html#cb862-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_function</span>(<span class="at">fun =</span> dnorm, <span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&#39;Normal&#39;</span>)) <span class="sc">+</span>      </span>
<span id="cb862-4"><a href="testing-generic-simulation-sequences.html#cb862-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">geom_histogram</span>(<span class="fu">aes</span>(<span class="at">y =</span> ..density..), <span class="at">alpha =</span> <span class="fl">0.4</span>) <span class="sc">+</span>      </span>
<span id="cb862-5"><a href="testing-generic-simulation-sequences.html#cb862-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">&#39;Density&#39;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;red&#39;</span>, <span class="st">&#39;blue&#39;</span>)) <span class="sc">+</span></span>
<span id="cb862-6"><a href="testing-generic-simulation-sequences.html#cb862-6" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_bw</span>()</span></code></pre></div>
<pre><code>## `stat_bin()` using `bins = 30`. Pick better value with `binwidth`.</code></pre>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:exphist"></span>
<img src="bookdownproj_files/figure-html/exphist-1.png" alt="Histogram of the sequence x2 together with theoretical pdf of the standard Normal" width="50%" />
<p class="caption">
Figure 4.10: Histogram of the sequence x2 together with theoretical pdf of the standard Normal
</p>
</div>
</div>
<div id="empirical-cumulative-distribution-function" class="section level4" number="4.6.1.2">
<h4><span class="header-section-number">4.6.1.2</span> Empirical Cumulative Distribution Function</h4>
<p>We have already seen for uniform numbers that we can use the empirical cdf to assess if a sequence of numbers is uniformly distributed. We can use the exact same method for any other distribution.</p>
<p>Figure <a href="testing-generic-simulation-sequences.html#fig:normecdf">4.11</a> reports the ecdf of the sequence of numbers <code>x1</code> (in red) together with the theoretical cdf of the standard Normal (in blue). We can see that the two functions match closely and therefore we could assume that the sequence is distributed as a standard Normal.</p>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb864-1"><a href="testing-generic-simulation-sequences.html#cb864-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x1, <span class="fu">aes</span>(x1)) <span class="sc">+</span></span>
<span id="cb864-2"><a href="testing-generic-simulation-sequences.html#cb864-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">&quot;step&quot;</span>,<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&#39;Empirical&#39;</span>)) <span class="sc">+</span></span>
<span id="cb864-3"><a href="testing-generic-simulation-sequences.html#cb864-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_function</span>(<span class="at">fun =</span> pnorm,<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&#39;Theoretical&#39;</span>)) <span class="sc">+</span></span>
<span id="cb864-4"><a href="testing-generic-simulation-sequences.html#cb864-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_bw</span>() <span class="sc">+</span>      </span>
<span id="cb864-5"><a href="testing-generic-simulation-sequences.html#cb864-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">&#39;Density&#39;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;red&#39;</span>, <span class="st">&#39;blue&#39;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:normecdf"></span>
<img src="bookdownproj_files/figure-html/normecdf-1.png" alt="Empirical cdf the sequence x1 together with theoretical cdf of the standard Normal" width="50%" />
<p class="caption">
Figure 4.11: Empirical cdf the sequence x1 together with theoretical cdf of the standard Normal
</p>
</div>
<p>Figure <a href="testing-generic-simulation-sequences.html#fig:expecdf">4.12</a> reports the same plot but for the sequence <code>x2</code>. The two lines strongly differ and therefore it cannot be assume that the sequence is distributed as a standard Normal.</p>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="testing-generic-simulation-sequences.html#cb865-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x2, <span class="fu">aes</span>(x2)) <span class="sc">+</span></span>
<span id="cb865-2"><a href="testing-generic-simulation-sequences.html#cb865-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_ecdf</span>(<span class="at">geom =</span> <span class="st">&quot;step&quot;</span>,<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&#39;Empirical&#39;</span>)) <span class="sc">+</span></span>
<span id="cb865-3"><a href="testing-generic-simulation-sequences.html#cb865-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_function</span>(<span class="at">fun =</span> pnorm,<span class="fu">aes</span>(<span class="at">colour =</span> <span class="st">&#39;Theoretical&#39;</span>)) <span class="sc">+</span></span>
<span id="cb865-4"><a href="testing-generic-simulation-sequences.html#cb865-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_bw</span>() <span class="sc">+</span>      </span>
<span id="cb865-5"><a href="testing-generic-simulation-sequences.html#cb865-5" aria-hidden="true" tabindex="-1"></a>   <span class="fu">scale_colour_manual</span>(<span class="at">name =</span> <span class="st">&#39;Density&#39;</span>, <span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;red&#39;</span>, <span class="st">&#39;blue&#39;</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:expecdf"></span>
<img src="bookdownproj_files/figure-html/expecdf-1.png" alt="Empirical cdf the sequence x2 together with theoretical cdf of the standard Normal" width="50%" />
<p class="caption">
Figure 4.12: Empirical cdf the sequence x2 together with theoretical cdf of the standard Normal
</p>
</div>
</div>
<div id="qq-plot" class="section level4" number="4.6.1.3">
<h4><span class="header-section-number">4.6.1.3</span> QQ-Plot</h4>
<p>A third visualization of the distribution of a sequence of numbers is the so called <em>QQ-plot</em>. You may have already seen this when checking if the residuals of a linear regression follow a Normal distribution. But more generally, qq-plots can be used to check if a sequence of numbers is distributed according to any distribution.</p>
<p>We will not the details about how these are constructed but just their interpretation and implementation. Let’s consider Figure <a href="testing-generic-simulation-sequences.html#fig:qqnorm">4.13</a>. The plot is composed of a series of points, where each point is associated to a number in our random sequence, and a line, which describes the theoretical distribution we are targeting. The closest the points and the line are, the better the fit to that distribution.</p>
<p>In particular, in Figure <a href="testing-generic-simulation-sequences.html#fig:qqnorm">4.13</a> we are checking if the sequence <code>x1</code> is distributed according to a standard Normal (represented by the straight line). Since the points are placed almost in a straight line over the theoretical line of the standard Normal, we can assume the sequence to be Normal.</p>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb866-1"><a href="testing-generic-simulation-sequences.html#cb866-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x1, <span class="fu">aes</span>(<span class="at">sample =</span> x1)) <span class="sc">+</span></span>
<span id="cb866-2"><a href="testing-generic-simulation-sequences.html#cb866-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_qq</span>(<span class="at">distribution =</span> qnorm) <span class="sc">+</span></span>
<span id="cb866-3"><a href="testing-generic-simulation-sequences.html#cb866-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_qq_line</span>(<span class="at">distribution =</span> qnorm) <span class="sc">+</span></span>
<span id="cb866-4"><a href="testing-generic-simulation-sequences.html#cb866-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:qqnorm"></span>
<img src="bookdownproj_files/figure-html/qqnorm-1.png" alt="QQ-plot for the sequence x1 checking against the standard Normal" width="50%" />
<p class="caption">
Figure 4.13: QQ-plot for the sequence x1 checking against the standard Normal
</p>
</div>
<p>Figure <a href="testing-generic-simulation-sequences.html#fig:qqexp">4.14</a> reports the qq-plot for the sequence <code>x2</code> to check if the data can be following a standard Normal. We can see that the points do not differ too much from the straight line and in this case we could assume the data to be Normal (notice that the histograms and the cdf strongly suggested that this sequence was not Normal).</p>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="testing-generic-simulation-sequences.html#cb867-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x2, <span class="fu">aes</span>(<span class="at">sample =</span> x2)) <span class="sc">+</span></span>
<span id="cb867-2"><a href="testing-generic-simulation-sequences.html#cb867-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_qq</span>(<span class="at">distribution =</span> qnorm) <span class="sc">+</span></span>
<span id="cb867-3"><a href="testing-generic-simulation-sequences.html#cb867-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_qq_line</span>(<span class="at">distribution =</span> qnorm) <span class="sc">+</span></span>
<span id="cb867-4"><a href="testing-generic-simulation-sequences.html#cb867-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:qqexp"></span>
<img src="bookdownproj_files/figure-html/qqexp-1.png" alt="QQ-plot for the sequence x2 checking against the standard Normal" width="50%" />
<p class="caption">
Figure 4.14: QQ-plot for the sequence x2 checking against the standard Normal
</p>
</div>
<p>Notice that the form of the qq-plot does not only depend on the sequence of numbers we are considering, but also on the distribution we are testing it against. Figure <a href="testing-generic-simulation-sequences.html#fig:qqnorm">4.13</a> reports the qq-plot for the sequence <code>x1</code> when checked against an Exponential random variable with parameter <span class="math inline">\(\lambda =3\)</span>. Given that the sequence also includes negative numbers, it does not make sense to check if it is distributed as an Exponential (since it can only model non-negative data), but this is just an illustration.</p>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb868-1"><a href="testing-generic-simulation-sequences.html#cb868-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(x1, <span class="fu">aes</span>(<span class="at">sample =</span> x1)) <span class="sc">+</span></span>
<span id="cb868-2"><a href="testing-generic-simulation-sequences.html#cb868-2" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_qq</span>(<span class="at">distribution =</span> qexp, <span class="at">dparams =</span> (<span class="at">rate =</span> <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb868-3"><a href="testing-generic-simulation-sequences.html#cb868-3" aria-hidden="true" tabindex="-1"></a>   <span class="fu">stat_qq_line</span>(<span class="at">distribution =</span> qexp, <span class="at">dparams =</span> (<span class="at">rate =</span> <span class="dv">3</span>)) <span class="sc">+</span></span>
<span id="cb868-4"><a href="testing-generic-simulation-sequences.html#cb868-4" aria-hidden="true" tabindex="-1"></a>   <span class="fu">theme_bw</span>()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:qqnorm1"></span>
<img src="bookdownproj_files/figure-html/qqnorm1-1.png" alt="QQ-plot for the sequence x1 checking against an Exponential" width="50%" />
<p class="caption">
Figure 4.15: QQ-plot for the sequence x1 checking against an Exponential
</p>
</div>
</div>
<div id="formal-testing" class="section level4" number="4.6.1.4">
<h4><span class="header-section-number">4.6.1.4</span> Formal Testing</h4>
<p>The above plots are highly informative since they provide insights into the shape of the data distribution, but these are not formal. Again, we can carry out tests of hypothesis to check if data is distributed as a specific random variable, just like we did for the Uniform.</p>
<p>Again, there are many tests one could use, but here we focus only on the Kolmogorov-Smirnov Test which checks how close the empirical and the theoretical cdfs are. It is implemented in the <code>ks.test</code> R function.</p>
<p>Let’s check if the sequences <code>x1</code> and <code>x2</code> are distributed as a standard Normal.</p>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb869-1"><a href="testing-generic-simulation-sequences.html#cb869-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(x1,pnorm)</span></code></pre></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  x1
## D = 0.041896, p-value = 0.3439
## alternative hypothesis: two-sided</code></pre>
<div class="sourceCode" id="cb871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb871-1"><a href="testing-generic-simulation-sequences.html#cb871-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(x2,pnorm)</span></code></pre></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  x2
## D = 0.2997, p-value &lt; 2.2e-16
## alternative hypothesis: two-sided</code></pre>
<p>The conclusion is that <code>x1</code> is distributed as a standard Normal since the p-value of the test is large and for instance bigger than 0.10. On the other hand, the p-value for the Kolmogorov-Smirnov test over the sequence <code>x2</code> has a very small p-value thus leading us to reject the null hypothesis that the sequence is Normally distributed.</p>
<p>Notice that we can add extra inputs to the function. For instance we can check if <code>x1</code> is distributed as a Normal with <code>mean = 2</code> and <code>sd = 2</code> using:</p>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb873-1"><a href="testing-generic-simulation-sequences.html#cb873-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(x1, pnorm, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="dv">2</span>)</span></code></pre></div>
<pre><code>## 
##  One-sample Kolmogorov-Smirnov test
## 
## data:  x1
## D = 0.54604, p-value &lt; 2.2e-16
## alternative hypothesis: two-sided</code></pre>
<p>The p-value is small and therefore we would reject the null hypothesis that the sequence is distributed as a Normal with mean two and standard deviation two.</p>
</div>
</div>
<div id="testing-independence-1" class="section level3" number="4.6.2">
<h3><span class="header-section-number">4.6.2</span> Testing Independence</h3>
<p>The other step in assessing if a sequence of numbers is pseudo-random is checking if independence holds. We have already learned that one possible way to do this is by computing the auto-correlation function with the R function <code>acf</code>. Let’s compute the auto-correlations of various lags for the sequences <code>x1</code> and <code>x2</code>, reported in Figure <a href="testing-generic-simulation-sequences.html#fig:acf12">4.16</a>. We can see that for <code>x2</code> all bars are within the confidence bands (recall that the first bar for lag <span class="math inline">\(k=0\)</span> should not be considered). For <code>x1</code> the bar corresponding to lag 1 is slightly outside the confidence bands, indicating that there may be some dependence.</p>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb875-1"><a href="testing-generic-simulation-sequences.html#cb875-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(x1)</span>
<span id="cb875-2"><a href="testing-generic-simulation-sequences.html#cb875-2" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(x2)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:acf12"></span>
<img src="bookdownproj_files/figure-html/acf12-1.png" alt="Autocorrelations for the sequences x1 and x2." width="50%" /><img src="bookdownproj_files/figure-html/acf12-2.png" alt="Autocorrelations for the sequences x1 and x2." width="50%" />
<p class="caption">
Figure 4.16: Autocorrelations for the sequences x1 and x2.
</p>
</div>
<p>Let’s run the Box test to assess if the assumption of independence is tenable for both sequences.</p>
<div class="sourceCode" id="cb876"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb876-1"><a href="testing-generic-simulation-sequences.html#cb876-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(x1, <span class="at">lag =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## 
##  Box-Pierce test
## 
## data:  x1
## X-squared = 8.4212, df = 5, p-value = 0.1345</code></pre>
<div class="sourceCode" id="cb878"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb878-1"><a href="testing-generic-simulation-sequences.html#cb878-1" aria-hidden="true" tabindex="-1"></a><span class="fu">Box.test</span>(x2, <span class="at">lag =</span> <span class="dv">5</span>)</span></code></pre></div>
<pre><code>## 
##  Box-Pierce test
## 
## data:  x2
## X-squared = 4.2294, df = 5, p-value = 0.5169</code></pre>
<p>In both cases the p-values are larger than 0.10, thus we would not reject the null hypothesis of independence for both sequences. Recall that <code>x1</code> is distributed as a standard Normal, whilst <code>x2</code> is not.</p>
<p>For the sequence <code>x1</code> we observed that one bar was slightly outside the confidence bands: this sometimes happens even when data is actually (pseudo-) random - I created <code>x1</code> using <code>rnorm</code>. The autocorrelations below are an instance of a case where independence is not tenable since we see that multiple bars are outside the confidence bands.
<img src="bookdownproj_files/figure-html/unnamed-chunk-429-1.png" width="50%" style="display: block; margin: auto;" /></p>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="random-variate-generation.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="monte-carlo-simulation.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/USERNAME/REPO/edit/BRANCH/04-Random.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/amartinezm90/SMUCbook/blob/master/04-Random.Rmd",
"text": null
},
"download": ["bookdownproj.pdf", "bookdownproj.epub"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
